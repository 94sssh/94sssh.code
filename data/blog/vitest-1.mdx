---
title: Vitest 알아보기
date: '2023-12-12'
tags: ['vitest', 'vite', 'test']
draft: false
summary: 테스팅 라이브러리 Vitest를 알아보자
layout: PostSimple
images: ['/static/images/vitest/vitest.png']
---

## 테스팅 라이브러리

Vitest는 테스팅 라이브러리입니다.  
테스트 코드 작성을 도와주는 도구로, 이를 통해 테스트 자동화를 구성할 수 있고 실행 결과가 기대와 일치하는지 확인할 수 있습니다.

테스트 코드를 작성하면 다음과 같은 장점을 얻을 수 있습니다.

1. **코드를 작성하기 전에 코드에 대해 생각하게 됩니다.**  
   단위 테스트를 작성해야 하므로, 기능에 대한 충분한 이해가 필요하고 이를 통해 명확한 기능에 대한 코드를 작성할 수 있습니다. 또한, 테스트를 위해 코드를 분리하면서 간결한 코드를 작성할 수 있습니다.

2. **버그를 예방할 수 있습니다.**  
   코드를 수정할 때 예상치 못한 부작용을 사전에 방지할 수 있고, 각 부분이 원하는 대로 작동하는지 확인할 수 있어 버그를 식별하고 예방할 수 있습니다.

3. **유지보수가 용이해집니다.**  
   대부분의 기능에 테스트를 작성하므로 최종적으로 문제가 있는 곳을 금방 파악할 수 있고, 기능을 추가하거나 변경할 때 기존 코드가 영향을 받는지 확인할 수 있습니다. 마찬가지로 리팩터링 과정에서 안정성을 유지할 수 있게 됩니다.

Jest 이전에는 Test Runner, Assertion Library, Test Mock 라이브러리 등을 조합하여 테스트 코드를 작성했습니다. 각각의 역할과 대표적인 라이브러리는 다음과 같습니다.

- Test Runner:  
  테스트 코드를 실행하는 주체로, 테스트 케이스를 찾고 실행하는 역할을 담당합니다. 각 테스트 케이스를 식별하며, 실행 및 결과를 나타내는 등의 작업을 수행합니다.  
  대표적으로 [Mocha](https://mochajs.org/)가 있습니다.  
  ![Mocha](/static/images/vitest/mocha.png)

- Assertion Library:
  테스트 코드에서 예상 결과와 실제 결과를 비교하고, 테스트를 더 명확하게 작성하는 데 도움이 되는 다양한 어설션(assertion) 함수를 제공합니다. 테스트 실행 시 실제 결과와 비교하여 코드의 정확성을 확인할 수 있습니다.  
  대표적으로 [Chai](https://www.chaijs.com/)가 있습니다.  
  ![Chai](/static/images/vitest/chai.png)

- Test Mock  
   테스트를 위한 모의 객체나 모듈을 생성하고, 특정 메서드가 호출되었는지, 얼마나 호출되었는지를 추적하거나 반환값을 설정하거나, 특정 조건이나 상황에서 어떻게 동작할지를 시뮬레이션하는 기능을 제공합니다.  
   대표적으로 [Sinon](https://sinonjs.org/)이 있습니다.  
  ![Sinon](/static/images/vitest/sinon.png)

이후 Jest의 등장으로, 대부분의 기능을 담은 Jest가 대표적인 테스팅 라이브러리가 되었습니다.  
![JestNpmTrends](/static/images/vitest/jestnpmtrends.png)  
_(적절한 비교가 아닐 수도 있지만...)_

그렇지만 이번에 사용할 테스팅 라이브러리는 Jest가 아닌 Vitest입니다.  
현재 프로젝트는 Vite를 사용 중인데 굉장히 만족스럽게 사용하고 있습니다.  
이러한 Vite에 최적화되어 있는 테스팅 프레임워크이기도 하고, ESM을 사용하여 모듈을 로드하고 실행해 보다 빠른 속도와 성능 최적화를 지원합니다.  
아직 v1.0.4로 v1.0.0이 릴리즈된 지 정확히 일주일밖에 되지 않았지만 기존 Jest의 장점을 따르면서 Vitest만의 매력이 있다고 생각해서 사용해 볼 생각입니다.

테스트 주도 개발에 대해 '테스트를 위한 테스트가 되어간다.', '테스트 코드 작성에 시간이 많이 쓰인다.'는 말을 듣고 테스트가 필요하지 않겠다는 생각을 했었습니다.  
지금은 생각을 바꿔 테스트의 필요성과 중요성을 느끼고 Vitest를 도입하고자 내용을 정리해 보려고 합니다.

## 설치

```
npm install -D vitest
```

```
yarn add -D vitest
```

## 세팅

vitest를 사용하기 위해서 몇가지 세팅이 필요하다.

```json
{
  "scripts": {
    "test": "vitest"
  }
}
```

## 테스트 코드

```javascript
// sum.js
export function sum(a, b) {
  return a + b
}
```

```javascript
// sum.test.js
import { expect, test } from 'vitest'
import { sum } from './sum'

test('adds 1 + 2 to equal 3', () => {
  expect(sum(1, 2)).toBe(3)
})
```

```javascript

```

```javascript

```

```javascript

```

```javascript

```
