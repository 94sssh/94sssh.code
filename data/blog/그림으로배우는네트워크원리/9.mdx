---
title: '[네트워크 원리] - 06. 라우팅(2)'
date: '2024-09-29T00:00:00'
tags: ['그림으로배우는네트워크원리', 'book', 'network']
draft: false
summary: 06. 라우팅(2)
layout: PostSimple
---

## 라우팅

### 방대한 경로 정보를 모아서 등록하는 방법

모든 네트워크의 경로 정보를 라우팅 테이블에 등록하기는 어려움.  
라우팅 동작은 이웃 라우터(넥스트 홉)까지만 보내면 되므로, 네트워크를 일일이 등록할 필요가 없어짐.  
넥스트 홉이 공통인 원격 네트워크의 경로 정보를 하나 모아 등록하는 **경로 요약**을 통해 항목을 줄일 수 있음.

### 경로 정보를 최대한으로 줄이는 방법

**디폴트 경로**: `0.0.0.0/0`으로 나타내는 모든 네트워크를 집약한 경로 정보  
디폴트 경로를 라우팅 테이블에 등록하면, 모든 네트워크의 경로 정보를 등록한 게 됨.  
디폴트 경로는 모든 네트워크를 나타낸다. 인터넷의 방대한 네트워크들의 넥스트 홉이 대부분 공통이라, 디폴트 경로를 라우팅 테이블에 등록하는 경우가 많다.

### 라우터와 레이어2 스위치의 기능을 가진 데이터 전송 기기

**레이어3 스위치**: 레이어2 스위치에 라우터 기능을 추가한 네트워크 기기  
레이어3 스위치는 같은 네트워크로 데이터를 전송할 때는 레이어2 스위치처럼 MAC 주소를 기반으로, 다른 네트워크로 전송할 때는 라우터처럼 IP 주소를 기반으로 전송.

**레이어2 스위치와 라우터의 데이터 전송 특징**  
| 특징 | 레이어2 스위치 | 라우터 |
|-----|--------------|--------|
| 데이터 | 이더넷 프레임 | IP 패킷 |
| 데이터 전송범위 | 동일 네트워크 | 다른 네트워크 |
| 전송을 위한 테이블 | MAC 주소 테이블 | 라우팅 테이블 |
| 전송 시 참조하는 주소 | MAC 주소 | IP 주소 |
| 테이블에 필요한 정보가 없을 때의 동작 | 데이터 플러싱 | 데이터 폐기 |

### 레이어2 스위치로 네트워크를 분할한다

레이어2 스위치는 하나의 이더넷 네트워크를 구성하는 네트워크 기기이므로, 하나의 네트워크에 수많은 기기를 연결하면 불필요한 데이터 전송이 많이 발생하게 됨.  
레이어2 스위치에서 네트워크를 복수로 분할할 수 있게 하는 것이 **VLAN**.

**VLAN의 동작 원리**: 일반 레이어2 스위치는 모든 포트 사이에서 이더넷 프레임을 전송할 수 있는데, 그것을 VLAN으로 나누어 같은 VLAN에 할당한 포트끼리만 이더넷 프레임을 전송

### VLAN을 사용하는 이유

레이어2 스위치를 가상으로 분할해 1대의 레이어2 스위치를 가상으로 2대의 스위치로 다룰 수 있음.  
분할한 VLAN의 스위치가 될 포트는 자유롭게 설정할 수 있고, 네트워크를 분할해 VLAN 간의 데이터를 분리할 수 있음. 데이터가 전송되는 범위를 제한할 수 있어 보안이 향상됨.

라우터로 분할된 네트워크는 라우터로 서로 연결되어 있지만, VLAN으로 분할한 네트워크가 서로 통신하기 위해서는 라우터와 레이어3 스위치가 필요.  
라우터 또는 레이어3 스위치로 VLAN으로 분할한 네트워크를 서로 연결해 통신할 수 있게 하는 것을 VLAN 간 라우팅이라고 한다.

### 복수의 접속선을 한 줄로 깔끔하게 정리한다

VLAN은 1대뿐 아니라 복수의 스위치에 걸쳐서 만들 수도 있는데, 스위치 간 연결이 필요하며, 스위치 사이의 효율적인 연결을 위해 **태그 VLAN**포트가 있다.

태그 VLAN 포트로 송수신하는 이더넷 프레임에는 VLAN 태그가 추가됨. VLAN 태그로 스위치 사이에 전송되는 이더넷 프레임이 원래 어느 VLAN의 이더넷 프레임인지 알 수 있음.

VLAN 태그는 `IEEEE802.1Q`로 규정되어 있다.

### 기기 추가나 배선을 변경하지 않고 네트워크를 바꾼다

태그 VLAN 포트 === 할당한 VLAN별로 분할할 수 있는 포트

- VLAN: 레이어2 스위치를 가상으로 분할
- 태그 VLAN: 포트를 VLAN별로 가상으로 분할

VLAN 설정에 따라 네트워크를 어떻게 분할할지 자유롭게 결정할 수 있음

### 분할한 네트워크끼리 연결하는 방법

VLAN 간 통신을 위해서는 VLAN을 서로 연결해야 하고, 이를 VLAN 간 라우팅이라고 한다. 이를 위해 라우터 또는 레이어3 스위치가 필요하다. 이중에선 레이어3 스위치가 효율적이다.

레이어3 스위치에 IP 주소를 설정해 VLAN을 연결한다.

- 레이어3 스위치 내부의 가상 인터페이스(VLAN 인터페이스)에 IP 주소 설정
- 레이어3 스위치의 포트 자체에 IP 주소 설정

### PC에도 라우팅 테이블이 있다

PC나 서버 등 TCP/IP를 이용하는 모든 기기에는 라우팅 테이블이 있고, 라우팅 테이블에 따라 라우팅한다.

라우팅 테이블에 기재되지 않은 네트워크로는 IP 패킷을 보낼 수 없으므로, PC의 라우팅 테이블에 IP 패킷을 전송하고 싶은 모든 네트워크를 등록해 두어야 함.

PC의 라우팅 테이블은 자세히 경로 정보를 등록하지 않음.

- 직접 접속 경로: IP 주소 설정
- 디폴트 경로: 기본 게이트웨이의 IP 주소 설정

기본 게이트웨이의 IP 주소를 설정함으로써, PC의 라우팅 테이블에 디폴트 경로가 등록됨.
